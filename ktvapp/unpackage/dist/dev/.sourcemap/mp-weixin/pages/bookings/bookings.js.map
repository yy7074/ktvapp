{"version":3,"file":"bookings.js","sources":["pages/bookings/bookings.vue","pages/bookings/bookings.vue?type=page"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<!-- 状态栏占位 -->\n\t\t<view class=\"status-bar\" :style=\"{height: statusBarHeight + 'px'}\"></view>\n\t\t\n\t\t<!-- 头部导航 -->\n\t\t<view class=\"header\">\n\t\t\t<view class=\"back-btn\" @click=\"goBack\">\n\t\t\t\t<text class=\"back-icon\">‹</text>\n\t\t\t</view>\n\t\t\t<text class=\"header-title\">我的预约</text>\n\t\t</view>\n\t\t\n\t\t<!-- 预约列表 -->\n\t\t<view class=\"booking-list\" v-if=\"bookingList.length > 0\">\n\t\t\t<view \n\t\t\t\tclass=\"booking-item\" \n\t\t\t\tv-for=\"(item, index) in bookingList\" \n\t\t\t\t:key=\"index\"\n\t\t\t\t@click=\"viewBooking(item)\"\n\t\t\t>\n\t\t\t\t<view class=\"booking-header\">\n\t\t\t\t\t<view class=\"ktv-info\">\n\t\t\t\t\t\t<text class=\"ktv-name\">{{ item.ktv_name }}</text>\n\t\t\t\t\t\t<text class=\"booking-id\">#{{ item.id }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"status-badge\" :class=\"item.status\">\n\t\t\t\t\t\t<text class=\"status-text\">{{ getStatusText(item.status) }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"booking-details\">\n\t\t\t\t\t<view class=\"detail-row\">\n\t\t\t\t\t\t<text class=\"detail-label\">预约时间:</text>\n\t\t\t\t\t\t<text class=\"detail-value\">{{ item.booking_time }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"detail-row\">\n\t\t\t\t\t\t<text class=\"detail-label\">包厢类型:</text>\n\t\t\t\t\t\t<text class=\"detail-value\">{{ item.room_type }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"detail-row\">\n\t\t\t\t\t\t<text class=\"detail-label\">人数:</text>\n\t\t\t\t\t\t<text class=\"detail-value\">{{ item.people_count }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"detail-row\" v-if=\"item.remark\">\n\t\t\t\t\t\t<text class=\"detail-label\">备注:</text>\n\t\t\t\t\t\t<text class=\"detail-value\">{{ item.remark }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"booking-footer\">\n\t\t\t\t\t<text class=\"create-time\">{{ formatDate(item.created_at) }}</text>\n\t\t\t\t\t<view class=\"booking-actions\">\n\t\t\t\t\t\t<button \n\t\t\t\t\t\t\tv-if=\"item.status === 'pending'\" \n\t\t\t\t\t\t\tclass=\"cancel-btn\" \n\t\t\t\t\t\t\t@click.stop=\"cancelBooking(item)\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t取消预约\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button \n\t\t\t\t\t\t\tv-if=\"item.status === 'confirmed'\" \n\t\t\t\t\t\t\tclass=\"contact-btn\" \n\t\t\t\t\t\t\t@click.stop=\"contactService\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t联系客服\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 空状态 -->\n\t\t<view class=\"empty-state\" v-else>\n\t\t\t<image src=\"/static/画板.png\" class=\"empty-icon\" mode=\"aspectFit\"></image>\n\t\t\t<text class=\"empty-text\">暂无预约记录</text>\n\t\t\t<button class=\"goto-booking-btn\" @click=\"goToHome\">去预约</button>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tstatusBarHeight: 0,\n\t\t\tbookingList: []\n\t\t}\n\t},\n\tonLoad() {\n\t\t// 获取状态栏高度\n\t\ttry {\n\t\t\tif (uni.getWindowInfo) {\n\t\t\t\tconst windowInfo = uni.getWindowInfo();\n\t\t\t\tthis.statusBarHeight = windowInfo.statusBarHeight;\n\t\t\t} else {\n\t\t\t\tconst systemInfo = uni.getSystemInfoSync();\n\t\t\t\tthis.statusBarHeight = systemInfo.statusBarHeight;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.log('获取系统信息失败，使用默认值');\n\t\t\tthis.statusBarHeight = 44;\n\t\t}\n\t\t\n\t\tthis.getBookingList();\n\t},\n\tmethods: {\n\t\tgetBookingList() {\n\t\t\t// 获取本地存储的预约记录\n\t\t\tconst mockBookings = uni.getStorageSync('mockBookings') || [];\n\t\t\tthis.bookingList = mockBookings.sort((a, b) => \n\t\t\t\tnew Date(b.created_at) - new Date(a.created_at)\n\t\t\t);\n\t\t},\n\t\t\n\t\tgetStatusText(status) {\n\t\t\tconst statusMap = {\n\t\t\t\t'pending': '待确认',\n\t\t\t\t'confirmed': '已确认',\n\t\t\t\t'completed': '已完成',\n\t\t\t\t'cancelled': '已取消'\n\t\t\t};\n\t\t\treturn statusMap[status] || '未知';\n\t\t},\n\t\t\n\t\tformatDate(dateString) {\n\t\t\tconst date = new Date(dateString);\n\t\t\treturn date.toLocaleString('zh-CN');\n\t\t},\n\t\t\n\t\tviewBooking(item) {\n\t\t\tuni.navigateTo({\n\t\t\t\turl: `/pages/booking/booking?id=${item.id}&mode=view`\n\t\t\t});\n\t\t},\n\t\t\n\t\tcancelBooking(item) {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '确认取消',\n\t\t\t\tcontent: '确定要取消这个预约吗？',\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t// 更新预约状态\n\t\t\t\t\t\tconst mockBookings = uni.getStorageSync('mockBookings') || [];\n\t\t\t\t\t\tconst index = mockBookings.findIndex(booking => booking.id === item.id);\n\t\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\t\tmockBookings[index].status = 'cancelled';\n\t\t\t\t\t\t\tuni.setStorageSync('mockBookings', mockBookings);\n\t\t\t\t\t\t\tthis.getBookingList();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '预约已取消',\n\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t\n\t\tcontactService() {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '联系客服',\n\t\t\t\tcontent: '客服电话：400-123-4567\\n工作时间：9:00-22:00',\n\t\t\t\tshowCancel: false,\n\t\t\t\tconfirmText: '知道了'\n\t\t\t});\n\t\t},\n\t\t\n\t\tgoToHome() {\n\t\t\tuni.switchTab({\n\t\t\t\turl: '/pages/index/index'\n\t\t\t});\n\t\t},\n\t\t\n\t\tgoBack() {\n\t\t\tuni.navigateBack();\n\t\t}\n\t}\n}\n</script>\n\n<style scoped>\n.container {\n\tmin-height: 100vh;\n\tbackground: #323641;\n\tcolor: white;\n}\n\n.status-bar {\n\twidth: 100%;\n}\n\n.header {\n\tdisplay: flex;\n\talign-items: center;\n\tpadding: 20rpx 40rpx;\n\tposition: relative;\n\tbackground: #21212A;\n}\n\n.back-btn {\n\twidth: 60rpx;\n\theight: 60rpx;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n.back-icon {\n\tfont-size: 40rpx;\n\tcolor: white;\n\tfont-weight: 200;\n}\n\n.header-title {\n\tposition: absolute;\n\tleft: 50%;\n\ttransform: translateX(-50%);\n\tfont-size: 36rpx;\n\tfont-weight: 500;\n}\n\n.booking-list {\n\tpadding: 30rpx;\n}\n\n.booking-item {\n\tbackground: #21212A;\n\tborder-radius: 20rpx;\n\tpadding: 30rpx;\n\tmargin-bottom: 20rpx;\n\tborder: 1rpx solid rgba(255, 255, 255, 0.1);\n}\n\n.booking-header {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: flex-start;\n\tmargin-bottom: 20rpx;\n}\n\n.ktv-info {\n\tflex: 1;\n}\n\n.ktv-name {\n\tfont-size: 32rpx;\n\tfont-weight: 500;\n\tcolor: white;\n\tdisplay: block;\n\tmargin-bottom: 8rpx;\n}\n\n.booking-id {\n\tfont-size: 24rpx;\n\tcolor: #999999;\n}\n\n.status-badge {\n\tpadding: 8rpx 16rpx;\n\tborder-radius: 20rpx;\n\tfont-size: 24rpx;\n}\n\n.status-badge.pending {\n\tbackground: rgba(255, 149, 0, 0.2);\n}\n\n.status-badge.confirmed {\n\tbackground: rgba(126, 211, 33, 0.2);\n}\n\n.status-badge.completed {\n\tbackground: rgba(153, 153, 153, 0.2);\n}\n\n.status-badge.cancelled {\n\tbackground: rgba(255, 59, 48, 0.2);\n}\n\n.status-text {\n\tfont-size: 24rpx;\n\tfont-weight: 500;\n}\n\n.status-badge.pending .status-text {\n\tcolor: #FF9500;\n}\n\n.status-badge.confirmed .status-text {\n\tcolor: #7ED321;\n}\n\n.status-badge.completed .status-text {\n\tcolor: #999999;\n}\n\n.status-badge.cancelled .status-text {\n\tcolor: #FF3B30;\n}\n\n.booking-details {\n\tmargin-bottom: 20rpx;\n}\n\n.detail-row {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tmargin-bottom: 12rpx;\n}\n\n.detail-label {\n\tfont-size: 28rpx;\n\tcolor: #CCCCCC;\n}\n\n.detail-value {\n\tfont-size: 28rpx;\n\tcolor: white;\n\tfont-weight: 500;\n}\n\n.booking-footer {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tpadding-top: 20rpx;\n\tborder-top: 1rpx solid rgba(255, 255, 255, 0.1);\n}\n\n.create-time {\n\tfont-size: 24rpx;\n\tcolor: #999999;\n}\n\n.booking-actions {\n\tdisplay: flex;\n\tgap: 20rpx;\n}\n\n.cancel-btn {\n\tbackground: transparent;\n\tborder: 1rpx solid #FF3B30;\n\tcolor: #FF3B30;\n\tfont-size: 24rpx;\n\tpadding: 12rpx 24rpx;\n\tborder-radius: 20rpx;\n}\n\n.contact-btn {\n\tbackground: #7ED321;\n\tcolor: #1C1C1E;\n\tfont-size: 24rpx;\n\tpadding: 12rpx 24rpx;\n\tborder-radius: 20rpx;\n\tborder: none;\n}\n\n.empty-state {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 120rpx 60rpx;\n}\n\n.empty-icon {\n\twidth: 200rpx;\n\theight: 200rpx;\n\topacity: 0.3;\n\tmargin-bottom: 40rpx;\n}\n\n.empty-text {\n\tfont-size: 32rpx;\n\tcolor: #999999;\n\tmargin-bottom: 40rpx;\n}\n\n.goto-booking-btn {\n\tbackground: #7ED321;\n\tcolor: #1C1C1E;\n\tfont-size: 28rpx;\n\tpadding: 20rpx 60rpx;\n\tborder-radius: 50rpx;\n\tborder: none;\n}\n</style> ","import MiniProgramPage from '/Users/yy/Documents/GitHub/ktvapp/ktvapp/pages/bookings/bookings.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;;AAkFA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,iBAAiB;AAAA,MACjB,aAAa,CAAC;AAAA,IACf;AAAA,EACA;AAAA,EACD,SAAS;AAER,QAAI;AACH,UAAIA,cAAAA,MAAI,eAAe;AACtB,cAAM,aAAaA,oBAAI;AACvB,aAAK,kBAAkB,WAAW;AAAA,aAC5B;AACN,cAAM,aAAaA,oBAAI;AACvB,aAAK,kBAAkB,WAAW;AAAA,MACnC;AAAA,IACC,SAAO,OAAO;AACfA,oBAAAA,MAAY,MAAA,OAAA,sCAAA,gBAAgB;AAC5B,WAAK,kBAAkB;AAAA,IACxB;AAEA,SAAK,eAAc;AAAA,EACnB;AAAA,EACD,SAAS;AAAA,IACR,iBAAiB;AAEhB,YAAM,eAAeA,cAAG,MAAC,eAAe,cAAc,KAAK,CAAA;AAC3D,WAAK,cAAc,aAAa;AAAA,QAAK,CAAC,GAAG,MACxC,IAAI,KAAK,EAAE,UAAU,IAAI,IAAI,KAAK,EAAE,UAAU;AAAA;IAE/C;AAAA,IAED,cAAc,QAAQ;AACrB,YAAM,YAAY;AAAA,QACjB,WAAW;AAAA,QACX,aAAa;AAAA,QACb,aAAa;AAAA,QACb,aAAa;AAAA;AAEd,aAAO,UAAU,MAAM,KAAK;AAAA,IAC5B;AAAA,IAED,WAAW,YAAY;AACtB,YAAM,OAAO,IAAI,KAAK,UAAU;AAChC,aAAO,KAAK,eAAe,OAAO;AAAA,IAClC;AAAA,IAED,YAAY,MAAM;AACjBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,6BAA6B,KAAK,EAAE;AAAA,MAC1C,CAAC;AAAA,IACD;AAAA,IAED,cAAc,MAAM;AACnBA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AACjB,cAAI,IAAI,SAAS;AAEhB,kBAAM,eAAeA,cAAG,MAAC,eAAe,cAAc,KAAK,CAAA;AAC3D,kBAAM,QAAQ,aAAa,UAAU,aAAW,QAAQ,OAAO,KAAK,EAAE;AACtE,gBAAI,UAAU,IAAI;AACjB,2BAAa,KAAK,EAAE,SAAS;AAC7BA,4BAAAA,MAAI,eAAe,gBAAgB,YAAY;AAC/C,mBAAK,eAAc;AAEnBA,4BAAAA,MAAI,UAAU;AAAA,gBACb,OAAO;AAAA,gBACP,MAAM;AAAA,cACP,CAAC;AAAA,YACF;AAAA,UACD;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACD;AAAA,IAED,iBAAiB;AAChBA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,YAAY;AAAA,QACZ,aAAa;AAAA,MACd,CAAC;AAAA,IACD;AAAA,IAED,WAAW;AACVA,oBAAAA,MAAI,UAAU;AAAA,QACb,KAAK;AAAA,MACN,CAAC;AAAA,IACD;AAAA,IAED,SAAS;AACRA,oBAAG,MAAC,aAAY;AAAA,IACjB;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClLA,GAAG,WAAW,eAAe;"}